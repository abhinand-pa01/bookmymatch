<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head}"></head>
<body class="d-flex flex-column min-vh-100">
<nav th:replace="~{fragments/header :: navbar}"></nav>

<main class="flex-grow-1">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">

                <!-- E-Ticket Card -->
                <div class="card shadow-lg border-primary" id="e-ticket">
                    <div class="card-header bg-primary text-white text-center py-4">
                        <h3><i class="bi bi-ticket-perforated-fill"></i> E-TICKET</h3>
                    </div>

                    <div class="card-body p-4">
                        <!-- Booking Code -->
                        <div class="text-center mb-4 p-3 bg-light rounded">
                            <h6 class="text-muted mb-2">BOOKING CODE</h6>
                            <h4 class="text-primary mb-0" th:text="${booking.bookingCode}">BOOKING-CODE</h4>
                        </div>

                        <!-- Match Details -->
                        <h5 class="mb-3">Match Details</h5>

                        <!-- Team Logos with SHORT NAMES -->
                        <div class="d-flex align-items-center justify-content-center mb-4 p-3 border rounded">
                            <!-- Home Team -->
                            <div class="text-center flex-fill">
                                <img th:if="${booking.match.homeTeam.logoUrl}"
                                     th:src="@{${booking.match.homeTeam.logoUrl}}"
                                     class="team-logo mb-2"
                                     th:alt="${booking.match.homeTeam.name}"
                                     style="width: 80px; height: 80px;"
                                     loading="lazy">
                                <div th:unless="${booking.match.homeTeam.logoUrl}"
                                     class="team-logo-placeholder mb-2"
                                     style="width: 80px; height: 80px; font-size: 2rem;">
                                    <i class="bi bi-shield-fill"></i>
                                </div>
                                <!-- SHORT NAME -->
                                <h6 class="mb-0 fw-bold" th:text="${booking.match.homeTeam.shortName}">HOM</h6>
                                <!-- Full name in small text -->
                                <small class="text-muted" th:text="${booking.match.homeTeam.name}">Home Team</small>
                            </div>

                            <div class="px-4">
                                <h3 class="mb-0 text-muted">VS</h3>
                            </div>

                            <!-- Away Team -->
                            <div class="text-center flex-fill">
                                <img th:if="${booking.match.awayTeam.logoUrl}"
                                     th:src="@{${booking.match.awayTeam.logoUrl}}"
                                     class="team-logo mb-2"
                                     th:alt="${booking.match.awayTeam.name}"
                                     style="width: 80px; height: 80px;"
                                     loading="lazy">
                                <div th:unless="${booking.match.awayTeam.logoUrl}"
                                     class="team-logo-placeholder mb-2"
                                     style="width: 80px; height: 80px; font-size: 2rem;">
                                    <i class="bi bi-shield-fill"></i>
                                </div>
                                <!-- SHORT NAME -->
                                <h6 class="mb-0 fw-bold" th:text="${booking.match.awayTeam.shortName}">AWY</h6>
                                <!-- Full name in small text -->
                                <small class="text-muted" th:text="${booking.match.awayTeam.name}">Away Team</small>
                            </div>
                        </div>

                        <!-- Stadium & Location -->
                        <div class="mb-3 p-3 bg-light rounded">
                            <p class="mb-2">
                                <i class="bi bi-building text-primary"></i>
                                <strong>Stadium</strong><br>
                                <span th:text="${booking.match.stadium.name}">Stadium Name</span>
                            </p>
                            <p class="mb-0">
                                <i class="bi bi-geo-alt-fill text-primary"></i>
                                <strong>Location</strong><br>
                                <span th:text="${booking.match.stadium.city}">City</span>
                            </p>
                        </div>

                        <!-- Date & Time -->
                        <div class="mb-3">
                            <p class="mb-2">
                                <i class="bi bi-calendar3 text-primary"></i>
                                <strong>Date</strong><br>
                                <span th:text="${#temporals.format(booking.match.matchDateTime, 'EEEE, dd MMMM yyyy')}">Date</span>
                            </p>
                            <p class="mb-0">
                                <i class="bi bi-clock-fill text-primary"></i>
                                <strong>Time</strong><br>
                                <span th:text="${#temporals.format(booking.match.matchDateTime, 'hh:mm a')}">Time</span>
                            </p>
                        </div>

                        <hr>

                        <!-- Ticket Details -->
                        <h5 class="mb-3">Ticket Details</h5>

                        <table class="table table-borderless">
                            <tr>
                                <td>Customer Name:</td>
                                <td class="text-end"><strong th:text="${booking.user.fullName}">Name</strong></td>
                            </tr>
                            <tr>
                                <td>Section:</td>
                                <td class="text-end"><strong th:text="${booking.ticketSection.sectionName}">Section</strong></td>
                            </tr>
                            <tr>
                                <td>Number of Tickets:</td>
                                <td class="text-end"><strong th:text="${booking.numberOfTickets}">0</strong></td>
                            </tr>
                            <tr>
                                <td>Price per Ticket:</td>
                                <td class="text-end">₹<span th:text="${booking.ticketSection.pricePerTicket}">0</span></td>
                            </tr>
                            <tr class="border-top">
                                <td><strong>Total Amount:</strong></td>
                                <td class="text-end"><h5 class="text-success mb-0">₹<span th:text="${booking.totalPrice}">0</span></h5></td>
                            </tr>
                        </table>

                        <!-- QR Code -->
                        <div class="text-center my-4">
                            <img th:src="@{https://api.qrserver.com/v1/create-qr-code/?size=200x200&data={code}(code=${booking.bookingCode})}"
                                 alt="QR Code"
                                 class="img-fluid">
                            <p class="text-muted small mt-2">Scan this QR code at the venue</p>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-grid gap-2">
                            <button onclick="window.print()" class="btn btn-primary">
                                <i class="bi bi-printer"></i> Print Ticket
                            </button>
                            <a th:href="@{/booking/my-tickets}" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-left"></i> Back to My Tickets
                            </a>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="card-footer text-center text-muted small">
                        <p class="mb-0">Please bring a valid ID to the venue</p>
                        <p class="mb-0">Booking Code: <strong th:text="${booking.bookingCode}">CODE</strong></p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</main>

<footer th:replace="~{fragments/footer :: footer}"></footer>

<!-- Print Styles -->
<style>
    @media print {
        nav, footer, .btn {
            display: none !important;
        }
        .card {
            border: none !important;
            box-shadow: none !important;
        }
    }
</style>
</body>
</html>
